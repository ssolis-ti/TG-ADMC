<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TG-ADMC Marketplace</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- [HARDENING]: Vendor library to prevent CDN failures -->
    <script src="static/js/vendor/tonconnect-ui.min.js?v=30"></script>
    <link rel="stylesheet" href="static/css/styles.css?v=30" />
  </head>

  <body>
    <!-- [MODULAR]: Onboarding Overlay -->
    <div id="onboarding-overlay" class="overlay" style="display: none">
      <div class="onboarding-card">
        <div id="onboarding-content">
          <!-- Multi-step content will be injected by JS -->
        </div>
        <div class="onboarding-footer">
          <button id="next-onboarding" class="btn">Next</button>
        </div>
      </div>
    </div>

    <header class="header">
      <h1>TG-ADMC</h1>
      <p>Marketplace â€¢ Escrow â€¢ Automation</p>
      <div id="ton-connect-btn" style="margin-top: 10px"></div>
    </header>

    <!-- [MVP REQ]: Navigation Tabs (Dynamic) -->
    <nav class="tabs" style="display: none">
      <button class="tab active" id="tab-left" data-target="left">
        Left Tab
      </button>
      <button class="tab" id="tab-right" data-target="right">Right Tab</button>
    </nav>

    <!-- [MODULAR]: View Containers -->
    <main id="app">
      <!-- DASHBOARD (Lobby) -->
      <section id="dashboard-view">
        <h2 style="text-align: center; margin-bottom: 20px">
          Choose your path
        </h2>

        <!-- [TG-COMPAT]: Fallback Manual Connection Button -->
        <div
          id="manual-connect-container"
          style="text-align: center; margin-bottom: 20px; display: none"
        >
          <button
            id="manual-connect-btn"
            class="btn"
            style="background: #0088cc; width: 100%"
          >
            ğŸ’ Connect Manual
          </button>
          <p style="font-size: 10px; opacity: 0.6; margin-top: 5px">
            Use this if header button is missing
          </p>
        </div>

        <div class="role-card" onclick="switchMode('advertiser')">
          <div class="role-icon">ğŸ“¢</div>
          <h3>Advertise Your Project</h3>
          <p>Find verified channels and publish your message.</p>
        </div>

        <div class="role-card" onclick="switchMode('owner')">
          <div class="role-icon">ğŸ“¡</div>
          <h3>Monetize Your Channel</h3>
          <p>Accept ad offers and earn TON automatically.</p>
        </div>
      </section>

      <!-- Dynamic Content Container -->
      <section id="dynamic-content" style="padding-bottom: 80px">
        <!-- Content injected by app.js based on role/tab -->
      </section>
    </main>

    <!-- [MODAL]: Campaign Creation -->
    <div
      id="campaign-modal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 2000;
        align-items: center;
        justify-content: center;
      "
    >
      <div
        style="
          background: var(--card-bg);
          padding: 20px;
          border-radius: 16px;
          width: 90%;
          max-width: 400px;
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        "
      >
        <h3 style="margin-top: 0">ğŸ“ Create Your Ad</h3>

        <label
          style="
            font-size: 12px;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
          "
          >Your Message</label
        >
        <textarea
          id="campaign-content"
          rows="6"
          style="
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-family: inherit;
            margin-bottom: 5px;
          "
          placeholder="Write your ad here..."
        ></textarea>
        <p style="font-size: 10px; color: #888; margin: 0 0 15px 0">
          ğŸ’¡ Tip: Use <b>**bold**</b> or add links to stand out
        </p>

        <label
          style="
            font-size: 12px;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
          "
          >Amount to Pay (TON)</label
        >
        <input
          type="number"
          id="campaign-amount"
          step="0.1"
          style="
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-bottom: 10px;
          "
        />

        <p
          style="
            font-size: 11px;
            color: #aaa;
            margin: 0 0 20px 0;
            padding: 10px;
            background: #1a1a1a;
            border-radius: 8px;
          "
        >
          ğŸ’¡ The channel owner will review your message before publishing.
        </p>

        <div style="display: flex; gap: 10px">
          <button
            onclick="
              document.getElementById('campaign-modal').style.display = 'none'
            "
            style="
              flex: 1;
              padding: 10px;
              border-radius: 8px;
              border: none;
              background: #eee;
              color: #333;
              font-weight: bold;
            "
          >
            Cancel
          </button>
          <button
            id="campaign-submit-btn"
            style="
              flex: 1;
              padding: 10px;
              border-radius: 8px;
              border: none;
              background: linear-gradient(90deg, #0088cc, #00aaff);
              color: white;
              font-weight: bold;
            "
          >
            Send Proposal
          </button>
        </div>
      </div>
    </div>

    <!-- Logic -->
    <!-- Logic (Modular) -->
    <script type="module" src="static/js/modules/main.js?v=30"></script>
  </body>
</html>
